<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Chatbot</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0; padding: 0; background: #f5f5f5;
  }
  .chat-container {
    max-width: 600px;
    margin: 40px auto;
    background: white;
    border-radius: 8px;
    box-shadow: 0 0 10px #ccc;
    display: flex;
    flex-direction: column;
    height: 80vh;
  }
  .messages {
    flex-grow: 1;
    padding: 10px;
    overflow-y: auto;
    border-bottom: 1px solid #ddd;
  }
  .message {
    margin: 8px 0;
    max-width: 70%;
    padding: 10px 14px;
    border-radius: 16px;
    clear: both;
  }
  .message.user {
    background: #0084ff;
    color: white;
    align-self: flex-end;
    border-bottom-right-radius: 0;
  }
  .message.bot {
    background: #e5e5ea;
    color: black;
    align-self: flex-start;
    border-bottom-left-radius: 0;
  }
  .input-area {
    display: flex;
    padding: 10px;
  }
  input[type="text"] {
    flex-grow: 1;
    padding: 10px 14px;
    font-size: 16px;
    border: 1px solid #ccc;
    border-radius: 20px;
    outline: none;
  }
  button {
    margin-left: 10px;
    padding: 0 20px;
    border: none;
    background: #0084ff;
    color: white;
    font-size: 16px;
    border-radius: 20px;
    cursor: pointer;
  }
  button:disabled {
    background: #7da8f8;
    cursor: not-allowed;
  }
</style>
</head>
<body>
  <div class="chat-container">
    <div class="messages" id="messages"></div>
    <form id="chat-form" class="input-area">
      <input type="text" id="user-input" placeholder="Ask about admissions, library, or hod_cs..." autocomplete="off" required />
      <button type="submit">Send</button>
    </form>
  </div>

<script>
  const messagesDiv = document.getElementById('messages');
  const chatForm = document.getElementById('chat-form');
  const userInput = document.getElementById('user-input');

  function addMessage(text, sender) {
    const div = document.createElement('div');
    div.classList.add('message', sender);
    div.textContent = text;
    messagesDiv.appendChild(div);
    messagesDiv.scrollTop = messagesDiv.scrollHeight; // auto scroll down
  }

  chatForm.addEventListener('submit', async (e) => {
    e.preventDefault();
    const text = userInput.value.trim();
    if (!text) return;

    addMessage(text, 'user');
    userInput.value = '';
    
    try {
      // Replace this URL with your deployed backend URL
      const response = await fetch(`https://chatbot-1-26vh.onrender.com/info?topic=${encodeURIComponent(text)}`);
      if (!response.ok) {
        addMessage("Sorry, I don't have information on that topic.", 'bot');
        return;
      }
      const data = await response.json();
      addMessage(data.response, 'bot');
    } catch (err) {
      addMessage('Error connecting to server.', 'bot');
    }
  });
</script>
</body>
</html>
